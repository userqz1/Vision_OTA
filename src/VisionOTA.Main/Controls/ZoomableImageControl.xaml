<UserControl x:Class="VisionOTA.Main.Controls.ZoomableImageControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="#1A1A1A"
             ClipToBounds="True">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 图像显示区域 -->
        <Border x:Name="ImageBorder" Grid.Row="0" Background="#1A1A1A" ClipToBounds="True"
                MouseWheel="OnMouseWheel"
                MouseLeftButtonDown="OnMouseLeftButtonDown"
                MouseLeftButtonUp="OnMouseLeftButtonUp"
                MouseMove="OnMouseMove"
                MouseRightButtonDown="OnMouseRightButtonDown"
                SizeChanged="OnContainerSizeChanged">

            <Image x:Name="DisplayImage"
                   Stretch="None"
                   RenderOptions.BitmapScalingMode="NearestNeighbor"
                   RenderTransformOrigin="0,0">
                <Image.RenderTransform>
                    <TransformGroup>
                        <ScaleTransform x:Name="ImageScale"/>
                        <TranslateTransform x:Name="ImageTranslate"/>
                    </TransformGroup>
                </Image.RenderTransform>
            </Image>
        </Border>

        <!-- 状态栏 -->
        <Border Grid.Row="1" Background="#2A2A2A" Padding="10,6">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- 左侧：尺寸 + 坐标 + 像素值 -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <!-- 图像尺寸 -->
                    <TextBlock Text="尺寸:" Foreground="#888888" FontSize="12"/>
                    <TextBlock x:Name="TxtSize" Text="--" Foreground="White" FontSize="12" Margin="4,0,16,0" MinWidth="80"/>

                    <!-- 坐标 -->
                    <TextBlock Text="坐标:" Foreground="#888888" FontSize="12"/>
                    <TextBlock x:Name="TxtCoord" Text="(-, -)" Foreground="#00BFFF" FontSize="12" Margin="4,0,16,0" MinWidth="80"/>

                    <!-- 像素值 -->
                    <TextBlock Text="像素:" Foreground="#888888" FontSize="12"/>
                    <TextBlock x:Name="TxtPixel" Text="--" Foreground="#00FF00" FontSize="12" Margin="4,0,0,0" MinWidth="120"/>
                </StackPanel>

                <!-- 中间：FPS -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock Text="FPS:" Foreground="#666666" FontSize="12"/>
                    <TextBlock x:Name="TxtFps" Text="--" Foreground="#FFD700" FontSize="12" FontWeight="Bold" Margin="4,0,0,0"/>
                </StackPanel>

                <!-- 右侧：缩放控制 -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock x:Name="TxtZoom" Text="100%" Foreground="White" FontSize="12"
                               Width="50" TextAlignment="Right" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <Button Content="适应" Click="OnFitClick"
                            Width="45" Height="22" FontSize="11"
                            Background="#444444" Foreground="White" BorderThickness="0" Margin="0,0,4,0"/>
                    <Button Content="1:1" Click="On100Click"
                            Width="35" Height="22" FontSize="11"
                            Background="#444444" Foreground="White" BorderThickness="0"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- 右键菜单 -->
        <Grid.ContextMenu>
            <ContextMenu>
                <MenuItem Header="适应窗口" Click="OnFitClick"/>
                <MenuItem Header="1:1 显示" Click="On100Click"/>
                <Separator/>
                <MenuItem Header="保存图片" Click="OnSaveClick"/>
            </ContextMenu>
        </Grid.ContextMenu>
    </Grid>
</UserControl>
